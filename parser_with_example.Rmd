---
title: "Literary Naming"
author: "–°—É—è–∑–æ–≤–∞ –°.–ê."
date: "`r format(Sys.Date(), '%d %b %Y')`"
output: 
    html_document:
      keep_md: yes
      toc: true
      toc_float: true
---


```{r setup, include = FALSE}



# –û–ü–¶–ò–ò –û–¢–ß–Å–¢–ê -----------------------------------------------------------------

# –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞
knitr::opts_chunk$set(echo = F, message = F, warning = F)
knitr::opts_chunk$set(dev.args = list(png = list(type = 'cairo')))
# –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —Ä–∏—Å—É–Ω–∫–∞
fig_count <- 0




# –ü–ê–ö–ï–¢–´ -----------------------------------------------------------------------

library("knitr")
library("readtext")
library("dplyr")
library("data.table")
library("wordcloud2")
library("RColorBrewer")
library("htmlwidgets")
library("webshot")




# –ö–û–ù–°–¢–ê–ù–¢–´ --------------------------------------------------------------------

# –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç—å—é
MAX_WORDS <- 5

# url —Ç–µ–∫—Å—Ç–∞ –∫–Ω–∏–≥–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
#  The Project Gutenberg eBook of The Man Who Was Thursday: A Nightmare
URL_BOOK <- "https://www.gutenberg.org/cache/epub/1695/pg1695.txt"

# url —Ç–∞–±–ª–∏—Ü—ã —Å–æ —Å–ª–æ–≤–∞—Ä—ë–º
URL_VOCABULARY <- 
    "https://raw.githubusercontent.com/nalgeon/words/refs/heads/main/data/oxford-5k.csv"

# url —Ñ–∞–π–ª–∞ —Å–æ —Å—Ç–æ–ø-—Å–ª–æ–≤–∞–º–∏
URL_STOP <- 
    "https://raw.githubusercontent.com/stopwords-iso/stopwords-en/refs/heads/master/stopwords-en.txt"

# —è–¥—Ä–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
my_seed <- 50825




# –§–£–ù–ö–¶–ò–ò ----------------------------------------------------------------------

# –æ–±—ä–µ–¥–∏–Ω—è–µ–º —á–∞—Å—Ç–æ—Ç—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ–æ—Ä–º –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Å–ª–æ–≤–∞
eval(parse('./functions/uf_combine_word_forms_frequencies.R', 
           encoding = 'UTF-8'))

# –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ
eval(parse('./functions/uf_random_two_words_by_book.R', 
           encoding = 'UTF-8'))

```


```{r load-data}

# –ü–ê–†–°–ï–† -----------------------------------------------------------------------



# 1. –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ =======================================


# <<< –¢–µ–∫—Å—Ç –∫–Ω–∏–≥–∏ —á–∏—Ç–∞–µ–º —Å URL <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
raw_txt <- readtext(URL_BOOK)
# str(raw_txt)
#...............................................................................


# <<< –°–ª–æ–≤–∞—Ä—å —Å—Ç–æ–ø-—Å–ª–æ–≤ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ —á–∏—Ç–∞–µ–º —Å URL <<<<<<<<<<<<<<<<<<<<<<<<<
#
stop_txt <- readLines(URL_STOP)
# str(stop_txt)
#
#...............................................................................


# <<< –°–ª–æ–≤–∞—Ä—å –û–∫—Å—Ñ–æ—Ä–¥—Å–∫–∏–π —á–∏—Ç–∞–µ–º —Å URL <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
#
DT_voc <- data.table(read.csv(URL_VOCABULARY)[, 1:3])
# str(DT_voc)
#
#...............................................................................


# <<< –í—Ä—É—á–Ω—É—é –¥–æ–ø–∏–ª–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å —Å–ª–æ–≤–∞—Ä—è –ø–æ–¥ —ç—Ç—É –∫–Ω–∏–≥—É –∏–∑ —Ñ–∞–π–ª–∞ <<<<<<<<<<<<<<<<<<
#
df_add <- read.csv2('./reference/additional_voc.csv')
# str(df_add)
#
#...............................................................................


# <<< –¢–∞–±–ª–∏—Ü–∞ —Å –æ–∫–æ–Ω—á–∞–Ω–∏—è–º–∏ –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —Å–ª–æ–≤–æ—Ñ–æ—Ä–º <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
#
df_endings <- read.csv2('./reference/word_endings.csv')
# str(df_add)
#
#...............................................................................

```


## –ò–¥–µ—è –ø–∞—Ä—Å–µ—Ä–∞    

–í–æ –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã—Ö –≤–µ–±-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö, —Ç—Ä–µ–±—É—é—â–∏—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–º—ë–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, Google API, –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ reddit, –∫–∞–ø—á–∞), –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–æ—á–µ—Ç–∞–Ω–∏—è –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–ª–æ–≤. –ö–æ–¥ —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ –∏–∑ –¥–≤—É—Ö —Å–ª–æ–≤, –æ–ø–µ—Ä–∏—Ä—É—è —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—â–µ –≤—Å–µ–≥–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–º —Ç–µ–∫—Å—Ç–µ. –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —ç—Ç–æ –æ–¥–∏–Ω —Ç–µ–∫—Å—Ç: "The Man Who Was Thursday" –∑–∞ –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ–º –ì.–ö.–ß–µ—Å—Ç–µ—Ä—Ç–æ–Ω–∞ –∏–∑ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ì—É—Ç–µ–Ω–±–µ—Ä–≥–∞ [^1].   

–†–µ—à–µ–Ω–∏–µ –∏–º–µ–µ—Ç –¥–≤–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:   

1. –í –ª—é–±–æ–º —Ç–µ–∫—Å—Ç–µ –±—É–¥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è —Ñ–æ—Ä–º—ã –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Å–ª–æ–≤–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ, –Ω–∞—Å—Ç–æ—è—â–µ–µ –∏ –ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è. –î–ª—è —É—á—ë—Ç–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ä–º —Å–ª–æ–≤ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞: –æ—Å–Ω–æ–≤–∞ –∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏–π: `r paste0(paste0(c('', '¬´')[as.numeric(df_endings$pattern_1 != '') + 1], df_endings$pattern_1, c('', '¬ª')[as.numeric(df_endings$pattern_1 != '') + 1]), c('', '/')[as.numeric(df_endings$pattern_1 != '') + 1], '¬´', df_endings$pattern_2, '¬ª')`. –ü—Ä–∏ —ç—Ç–æ–º –æ—Å–Ω–æ–≤–æ–π —Å–ª–æ–≤–∞ –º—ã –¥–∞–ª–µ–µ –±—É–¥–µ–º –Ω–∞–∑—ã–≤–∞—Ç—å –≤—Å—ë –∫—Ä–æ–º–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –æ–∫–æ–Ω—á–∞–Ω–∏–π.       

1. –ó–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ, —á—Ç–æ –∏–º–µ–Ω–∞ –≥–ª–∞–≤–Ω—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –∫–Ω–∏–≥ –±—É–¥—É—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è —á–∞—â–µ –∏–º—ë–Ω –Ω–∞—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö. –ò–∑ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏–π —É–ª—É—á—à–µ–Ω–∏—è –æ–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö, –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ –∏–∑ –∏–º—ë–Ω –Ω–∞—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö. –î–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å–ª–æ–≤ –Ω–∞ –∏–º–µ–Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏ –Ω–∞—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –º—ã –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Ö–æ–¥–∏—Ç –ª–∏ —Å–ª–æ–≤–æ –≤ —Ç–µ–∫—Å—Ç —Å –±–æ–ª—å—à–æ–π –∏–ª–∏ —Å –º–∞–ª–µ–Ω—å–∫–æ–π –±—É–∫–≤—ã, –ª–∏–±–æ –∏ —Ç–æ, –∏ –¥—Ä—É–≥–æ–µ. –≠—Ç–æ –ø–æ–¥—Ö–æ–¥ –∏–º–µ–µ—Ç –º–∏–Ω—É—Å—ã, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –∏–º—è –Ω–∞—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ, –≤—Å—Ç—Ä–µ—Ç–∏–≤—à–µ–µ—Å—è –æ–¥–∏–Ω —Ä–∞–∑, –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è –∏–º–µ–Ω–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º. –ú—ã –æ–±—Ö–æ–¥–∏–º —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –≤—ã–±–∏—Ä–∞—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ —Å–ª–æ–≤–∞ —Å —á–∞—Å—Ç–æ—Ç–æ–π –≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏ –≤—ã—à–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ—Ä–æ–≥–∞ $k > 1$.    

–ü–æ —Å—É—Ç–∏, 99% –∫–æ–¥–∞ —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á–∏ –æ—á–∏—Å—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –°—É—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ -- –ø–æ–¥—Å—á—ë—Ç —á–∞—Å—Ç–æ—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º ‚Ññ1, –æ–ø–∏—Å–∞–Ω–Ω—ã–º –≤—ã—à–µ.   


## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏   

–ö–æ–¥ —Ç—Ä–µ–±—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –ø–∞–∫–µ—Ç–æ–≤:   

* ```knitr``` [^3]
* ```readtext``` [^4]
* ```dplyr``` [^5]
* ```data.table``` [^6]
* ```wordcloud2``` [^7]
* ```RColorBrewer``` [^8]
* ```htmlwidgets``` [^9]
* ```webshot``` [^10]


## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã  

```{r clean-data}

# 2. –ß–∏—Å—Ç–∏–º –¥–∞–Ω–Ω—ã–µ =============================================================


# 1. –°—Ç–∞—Ä—Ç–æ–≤–∞—è –æ—á–∏—Å—Ç–∫–∞, —Ü–µ–ª—å - –≤–µ–∫—Ç–æ—Ä —Å–ª–æ–≤ —Å —á–∞—Å—Ç–æ—Ç–∞–º–∏ #########################

# –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç –∫–Ω–∏–≥–∏

#  * –≤—ã–∫–∏–¥—ã–≤–∞–µ–º –Ω–∞—á–∞–ª–æ:
#    –¥–æ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–µ—Ä–≤–æ–π –≥–ª–∞–≤—ã
search_pattern <- '(.*\n)(CHAPTER I.\nTHE TWO POETS OF SAFFRON PARK\n.*)'
replace_pattern <- '\\2'
clean_txt <- gsub(search_pattern, replace_pattern, raw_txt$text)

#  * –≤—ã–∫–∏–¥—ã–≤–∞–µ–º –æ–ø–∏—Å–∞–ª–æ–≤–æ –ª–∏—Ü–µ–Ω–∑–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –ì—É—Ç—Ç–µ–Ω–±–µ—Ä–≥–∞: 
#    –ø–æ—Å–ª–µ –∑–∞–¥–∞–Ω–Ω–æ–π —Ñ—Ä–∞–∑—ã
search_pattern <- '\\\\*\\\\*\\\\* END OF THE PROJECT GUTENBERG EBOOK THE MAN WHO WAS THURSDAY: A NIGHTMARE \\\\*\\\\*\\\\*.*'
replace_pattern <- ''
clean_txt <- gsub(search_pattern, replace_pattern, clean_txt)


# –†–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç—Ä–æ—á–Ω–æ
clean_txt <- strsplit(clean_txt, '\n')[[1]]


# –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
clean_txt <- clean_txt[clean_txt != '']


# –£–±–∏—Ä–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –≥–ª–∞–≤
chapter_num <- c(grep('CHAPTER ', clean_txt), grep('CHAPTER ', clean_txt) + 1)
clean_txt <- clean_txt[!(1:length(clean_txt) %in% chapter_num)]


# –£–±–∏—Ä–∞–µ–º –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è
clean_txt <- sapply(clean_txt, function(x){
    gsub('[[:punct:]]', '', x)
    }) %>% unname %>% unlist


# –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞
clean_txt <- strsplit(clean_txt, ' ') %>% unlist %>% unname
tbl <- table(clean_txt)
DT <- data.table(word = names(tbl), freq = as.vector(tbl))


# –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç–æ—Ç—ã
DT <- DT[!(DT$word == ''), ]


# –£–±–∏—Ä–∞–µ–º —á–∏—Å–ª–∞
DT <- DT[!grepl('\\d', DT$word), ]


# 2. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –æ—á–∏—Å—Ç–∫–∞: —Å—Ç—Ä–æ—á–Ω—ã–µ/–ø—Ä–æ–ø–∏—Å–Ω—ã–µ –±—É–∫–≤—ã –≤ –Ω–∞—á–∞–ª–µ —Å–ª–æ–≤ ###############

# —Ä–∞–±–æ—Ç–∞–µ–º —Å –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏
low_reg <- tolower(DT$word)

# —ç—Ç–∏ —Å–ª–æ–≤–∞ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –±–æ–ª—å—à–æ–π –±—É–∫–≤—ã
capital <- which(!(low_reg == DT$word))

# –Ω–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Å–æ —Å—Ç—Ä–æ—á–Ω–æ–π
lower_match <- sapply(capital, function(x){
    which(DT$word == tolower(DT$word[x]))
})

# –ø—Ä–∏–±–∞–≤–ª—è–µ–º –∫ —á–∞—Å—Ç–æ—Ç–∞–º —Å—Ç—Ä–æ—á–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç—ã –∑–∞–≥–ª–∞–≤–Ω—ã—Ö
DT[lower_match[sapply(lower_match, length) == 1] %>% unlist, 'freq'] <- 
    DT[lower_match[sapply(lower_match, length) == 1] %>% unlist, freq] + 
    DT[capital[sapply(lower_match, length) == 1], freq]

# —É–±–∏—Ä–∞–µ–º –∑–∞–≥–ª–∞–≤–Ω—ã–µ
DT <- DT[!capital[sapply(lower_match, length) == 1], ]

# –∏—Å–ø—Ä–∞–≤–ª—è–µ–º 'I' –Ω–∞ 'i'
DT[DT$word == 'I', 'word'] <- 'i'


# 3. –°–æ–≤–º–µ—â–∞–µ–º —Å–æ —Å–ª–æ–≤–∞—Ä—è–º–∏ ####################################################

# —É–±–∏—Ä–∞–µ–º —Å—Ç–æ–ø-—Å–ª–æ–≤–∞
DT <- DT %>% filter(!(DT$word %in% stop_txt))

# —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–ª–æ–≤ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞
DT <- arrange(DT, word)

# —Å–æ–≤–º–µ—â–∞–µ–º –ø—Ä–æ—Å—Ç—ã–µ —Å–ª–æ–≤–æ—Ñ–æ—Ä–º—ã
#  —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ü–∏–∫–ª –ø–æ –≤—Å–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–∞–º –æ–∫–æ–Ω—á–∞–Ω–∏–π –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É –¥–∞–Ω–Ω—ã—Ö
DT <- uf_combine_word_forms_frequencies(DT, df_endings)

# —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é —á–∞—Å—Ç–æ—Ç
DT <- arrange(DT, -freq)

# –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä–æ—á–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏ –∫–∞–∫ –∫–ª—é—á –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Å–ª–æ–≤–∞—Ä—è–º
DT$word_key <- tolower(DT$word)

```


```{r figure-01}

fig_count <- fig_count + 1

# >>> –†–∏—Å—É–Ω–æ–∫ 1 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# —Ä–∏—Å—É–µ–º –≤—Å–µ —Å–ª–æ–≤–∞ —Å —á–∞—Å—Ç–æ—Ç–æ–π –Ω–µ –º–µ–Ω–µ–µ 20
fig_01 <- wordcloud2(data = DT[DT$freq >= 20, ])
#
# ..............................................................................

flnm <- paste0('./plots/plot_', sprintf("%02d", fig_count))
saveWidget(fig_01, paste0(flnm, '.html'), selfcontained = TRUE)

tmp <- webshot(url = paste0(flnm,'.html'), file = paste0(flnm,'.png'), 
               delay = 7, vwidth = 800, vheight = 400)

```

–ü–æ—Å–ª–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –æ—Ç —Å—Ç–æ–ø-—Å–ª–æ–≤ –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –æ—Å—Ç–∞–ª–æ—Å—å `r format(nrow(DT), big.mark = ' ')` —Å–ª–æ–≤. –ù–∞ —Ä–∏—Å—É–Ω–∫–µ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–æ –æ–±–ª–∞–∫–æ —Å–ª–æ–≤ —Å —á–∞—Å—Ç–æ—Ç–æ–π –Ω–µ –º–µ–Ω–µ–µ 20 –¥–æ —Å–æ–æ—Ç–Ω–µ—Å–µ–Ω–∏—è —Å —á–∞—Å—Ç—è–º–∏ —Ä–µ—á–∏. –ß–∞—â–µ –≤—Å–µ–≥–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è "Syme" -- –∏–º—è –≥–ª–∞–≤–Ω–æ–≥–æ –≥–µ—Ä–æ—è –∫–Ω–∏–≥–∏. "Bull", "Gregory", "Dr" —Ç–∞–∫–∂–µ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –∏–º–µ–Ω–∞–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π.   

![](./plots/plot_01.png)

–†–∏—Å—É–Ω–æ–∫ `r fig_count`. –û–±–ª–∞–∫–æ —Å–ª–æ–≤ –ø–æ –∫–Ω–∏–≥–µ "The Man Who Was Thursday" —Å —á–∞—Å—Ç–æ—Ç–æ–π –Ω–µ –º–µ–Ω–µ–µ 20.   

–ß—Ç–æ–±—ã –ø–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∂–¥–æ–º—É —Å–ª–æ–≤—É –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —á–∞—Å—Ç—å —Ä–µ—á–∏, –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—É –ø–æ –û–∫—Å—Ñ–æ—Ä–¥—Å–∫–æ–º—É —Å–ª–æ–≤–∞—Ä—é [^2]. –°–ª–æ–≤–∞—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ –Ω–∞—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ, –ø–æ—ç—Ç–æ–º—É –∏–º–µ–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–∫—Ä–æ–º–µ Sunday, –∫–æ—Ç–æ—Ä–æ–µ –º—ã –æ—Å—Ç–∞–≤–∏–º –≤ –∏—Ç–æ–≥–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ). –ù–µ–∫–æ—Ç–æ—Ä—ã–º –Ω–∞—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∏ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–º –∏–∑ –∫–Ω–∏–≥–∏ —Ç–∞–∫–∂–µ –Ω–µ –Ω–∞—à–ª–æ—Å—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –≤ —ç—Ç–æ–º —Å–ª–æ–≤–∞—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, anarchist, feet), –∏ —á–∞—Å—Ç–∏ —Ä–µ—á–∏ –¥–ª—è –Ω–∏—Ö –ø—Ä–∏—à–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é.   


```{r calc-freq-01} 

# —Å–æ–≤–º–µ—â–∞–µ–º —Å –æ–∫—Å—Ñ–æ—Ä–¥—Å–∫–∏–º —Å–ª–æ–≤–∞—Ä—ë–º, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å —á–∞—Å—Ç—å —Ä–µ—á–∏
words_to_shuffle <- merge(DT, DT_voc[, -2], 
                          by.x = 'word_key', by.y = 'word') 

# –¥–æ–±–∞–≤–ª—è–µ–º —á–∞—Å—Ç—å —Å–ª–æ–≤–∞—Ä—è, —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –≤—Ä—É—á–Ω—É—é,
#  –æ—Å—Ç–∞–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å —á–∞—Å—Ç–æ—Ç–æ–π –Ω–µ –º–µ–Ω–µ–µ MAX_WORDS,
#  —Å–æ—Ä—Ç–∏—Ä—É–µ–º,
#  –¥–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç–æ–π —Å—Ç–æ–ª–±–µ—Ü –ø–æ–¥ —Ü–≤–µ—Ç–∞ –ø–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç—É
words_to_shuffle <- rbind(words_to_shuffle, df_add) %>% 
    filter(pos %in% c('noun', 'adjective'), freq >= MAX_WORDS) %>%
    arrange(pos, freq) %>% mutate(clrs = '')

# —Å–∫–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –≤ –∏—Ç–æ–≥–µ –æ—Å—Ç–∞–ª–æ—Å—å
tbl <- words_to_shuffle %>% count(pos)

```


–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã –æ–±—ä–µ–¥–∏–Ω–∏–ª–∏ —Å–ª–æ–≤–æ—Ñ–æ—Ä–º—ã, –æ—Å—Ç–∞–ª–æ—Å—å `r nrow(words_to_shuffle)` —Å–ª–æ–≤–∞, –∏–∑ –Ω–∏—Ö `r tbl[tbl$pos == 'noun', 'n']` —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö (—Å–º. —Ç–∞–±–ª–∏—Ü—É –Ω–∏–∂–µ).   

–¢–∞–±–ª–∏—Ü–∞ 1. -- –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –≤ –∏—Ç–æ–≥–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ —Å–ª–æ–≤ ```words_to_shuffle```    

```{r table-01}

# —Ç–∞–±–ª–∏—Ü–∞ 1 
kable(tbl, row.names = F,
      col.names = c('–ß–∞—Å—Ç—å —Ä–µ—á–∏', '–ß–∞—Å—Ç–æ—Ç–∞'))

```


```{r calc-freq-02}

# –∫–æ–¥–∏—Ä—É–µ–º —Ü–≤–µ—Ç–∞ –ø–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç—É –≤ —Å—Ç–æ–ª–±–µ—Ü clrs: 
#  –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏–Ω–∏–µ, —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∫—Ä–∞—Å–Ω—ã–µ
bluecols <- brewer.pal(5, 'Blues')
clrs_adj <- colorRampPalette(bluecols)

words_to_shuffle[grepl('adjective', words_to_shuffle$pos), 'clrs'] <- 
    clrs_adj(sum(grepl('adjective', words_to_shuffle$pos)))

redcols <- brewer.pal(5, 'Reds')
clrs_noun <- colorRampPalette(redcols)

words_to_shuffle[grepl('noun', words_to_shuffle$pos), 'clrs'] <- 
    clrs_noun(sum(grepl('noun', words_to_shuffle$pos)))

# —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É (–ø–æ —á–∞—Å—Ç–æ—Ç–∞–º –æ–±–ª–∞–∫–æ –≤—ã—Ö–æ–¥–∏—Ç —Å—Ç—Ä–∞–Ω–Ω–æ–µ),
#  –ø–ª—é—Å —Å—Ç–æ–ª–±–µ—Ü —Å –∏–Ω–¥–µ–∫—Å–æ–º –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
words_to_shuffle <- words_to_shuffle[, -1] %>% arrange(word) %>% 
    mutate(id = 1:dim(words_to_shuffle)[1])
```


–û–±–ª–∞–∫–æ —Å–ª–æ–≤ –¥–ª—è –∏—Ç–æ–≥–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–π –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ –≤—Ç–æ—Ä–æ–º —Ä–∏—Å—É–Ω–∫–µ. –ì—Ä–∞–¥–∏–µ–Ω—Ç —Ü–≤–µ—Ç–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–µ–Ω —á–∞—Å—Ç–æ—Ç–µ –≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏ —Å–ª–æ–≤–∞.   


```{r figure-02}

fig_count <- fig_count + 1

# >>> –†–∏—Å—É–Ω–æ–∫ 2 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
#
fig_02 <- wordcloud2(data = words_to_shuffle, color = words_to_shuffle$clrs)
#
# ..............................................................................

flnm <- paste0('./plots/plot_', sprintf("%02d", fig_count))
saveWidget(fig_02, paste0(flnm, '.html'), selfcontained = TRUE)

tmp <- webshot(url = paste0(flnm,'.html'), file = paste0(flnm,'.png'), 
               delay = 2)

```

![](./plots/plot_02.png)

–†–∏—Å—É–Ω–æ–∫ `r fig_count`. –û–±–ª–∞–∫–æ —Å–ª–æ–≤ –ø–æ –∫–Ω–∏–≥–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–π: –∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º –ø–æ–∫–∞–∑–∞–Ω—ã —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ, —Å–∏–Ω–∏–º - –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ.   

–§—É–Ω–∫—Ü–∏—è ```uf_random_two_words_by_book()``` –≤—ã–±–∏—Ä–∞–µ—Ç –∏–∑ –∏—Ç–æ–≥–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ –∏ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:    


```{r res-01, echo=T}

# 4. –ù–∞–∫–æ–Ω–µ—Ü —Å–æ—Å—Ç–∞–≤–ª—è–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Å–ª—É—á–∞–π–Ω–æ–µ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ ####################

uf_random_two_words_by_book(words_to_shuffle, my_seed)

```


–í —Ç–∞–±–ª–∏—Ü–µ –ø–æ–∫–∞–∑–∞–Ω–æ –µ—â—ë –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–π –Ω–∞ –±–∞–∑–µ –∫–Ω–∏–≥–∏.   


```{r}

# —è–¥—Ä–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
rnd_seed <- ceiling(rnorm(m = as.numeric(format(Sys.time(), "%S")), 
                          s = as.numeric(format(Sys.time(), "%M")), 
                          1:10) * 10)

tbl <- data.table(seed = rnd_seed, 
           two_words = sapply(rnd_seed, function(x){ 
               uf_random_two_words_by_book(words_to_shuffle, x)
               })) %>% unique %>% arrange(two_words)

```


–¢–∞–±–ª–∏—Ü–∞ 2. -- –ü—Ä–∏–º–µ—Ä—ã —Å–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–π –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å–≤—É—é—â–∏–µ —è–¥—Ä–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª    

```{r table-02}

# —Ç–∞–±–ª–∏—Ü–∞ 2 
kable(tbl, row.names = F,
      col.names = c('–Ø–¥—Ä–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª', '–°–ª–æ–≤–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ'))

```


## –ü–ª–∞–Ω—ã   

üî∏ üìã –ù–∞–π—Ç–∏ –±–æ–ª–µ–µ –ø–æ–ª–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —á–∞—Å—Ç–µ–π —Ä–µ—á–∏.    

üî∏ üìö –î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –∫–Ω–∏–≥–∏ –∏–∑ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ì—É—Ç—Ç–µ–Ω–±–µ—Ä–≥–∞.   



[^1]: Project Gutenberg. URL: [https://www.gutenberg.org/](https://www.gutenberg.org/).   

[^2]: –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Stopwords ISO –Ω–∞ github.com. URL: [https://github.com/stopwords-iso/stopwords-iso](https://github.com/stopwords-iso/stopwords-iso).  

[^3]: Xie Y (2025). _knitr: A General-Purpose Package for Dynamic Report
  Generation in R_. R package version 1.50, <https://yihui.org/knitr/>.    
  
[^4]: Benoit K, Obeng A (2025). _readtext: Import and Handling for Plain and
  Formatted Text Files_. doi:10.32614/CRAN.package.readtext
  <https://doi.org/10.32614/CRAN.package.readtext>, R package version 0.92.1,
  <https://CRAN.R-project.org/package=readtext>.    
  
[^5]: Wickham H, Fran√ßois R, Henry L, M√ºller K, Vaughan D (2023). _dplyr: A
  Grammar of Data Manipulation_. doi:10.32614/CRAN.package.dplyr
  <https://doi.org/10.32614/CRAN.package.dplyr>, R package version 1.1.4,
  <https://CRAN.R-project.org/package=dplyr>.    
  
[^6]: Barrett T, Dowle M, Srinivasan A, Gorecki J, Chirico M, Hocking T,
  Schwendinger B, Krylov I (2025). _data.table: Extension of `data.frame`_.
  doi:10.32614/CRAN.package.data.table
  <https://doi.org/10.32614/CRAN.package.data.table>, R package version
  1.17.8, <https://CRAN.R-project.org/package=data.table>.    
  
[^7]: Lang D, Chien G (2018). _wordcloud2: Create Word Cloud by 'htmlwidget'_.
  doi:10.32614/CRAN.package.wordcloud2
  <https://doi.org/10.32614/CRAN.package.wordcloud2>, R package version
  0.2.1, <https://CRAN.R-project.org/package=wordcloud2>.    
  
[^8]: Neuwirth E (2022). _RColorBrewer: ColorBrewer Palettes_.
  doi:10.32614/CRAN.package.RColorBrewer
  <https://doi.org/10.32614/CRAN.package.RColorBrewer>, R package version
  1.1-3, <https://CRAN.R-project.org/package=RColorBrewer>.    
  
[^9]: Vaidyanathan R, Xie Y, Allaire J, Cheng J, Sievert C, Russell K (2023).
  _htmlwidgets: HTML Widgets for R_. doi:10.32614/CRAN.package.htmlwidgets
  <https://doi.org/10.32614/CRAN.package.htmlwidgets>, R package version
  1.6.4, <https://CRAN.R-project.org/package=htmlwidgets>.    
  
[^10]: Chang W (2023). _webshot: Take Screenshots of Web Pages_.
  doi:10.32614/CRAN.package.webshot
  <https://doi.org/10.32614/CRAN.package.webshot>, R package version 0.5.5,
  <https://CRAN.R-project.org/package=webshot>.    

[^11]: –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Oxford Word Lists –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è nalgeon –Ω–∞ github.com. URL: [https://github.com/nalgeon/words](https://github.com/nalgeon/words).   
